<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Admin ‚Äì Messages de contact</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .message-preview {
      max-width: 420px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .unseen {
      background-color: #fff6f6;
    }
  </style>
</head>
<body class="container mt-4">

<h1 class="mb-3">üì© Messages de contact</h1>

<p class="text-muted">
  Total : <strong>{{ total }}</strong>
</p>

{% if messages %}
<table class="table table-hover align-middle">
  <thead class="table-light">
    <tr>
      <th>Statut</th>
      <th>Nom</th>
      <th>Email</th>
      <th>Sujet</th>
      <th>Message</th>
      <th>Date</th>
    </tr>
  </thead>
  <tbody>
    {% for msg in messages %}
    <tr class="{% if not msg.seen %}unseen{% endif %}">
      <td>
        {% if not msg.seen %}
          <span class="badge bg-danger">Nouveau</span>
        {% else %}
          <span class="badge bg-secondary">Lu</span>
        {% endif %}
      </td>
      <td>
        {{ msg.first_name }} {{ msg.last_name }}
      </td>
      <td>
        <a href="mailto:{{ msg.email }}">{{ msg.email }}</a>
      </td>
      <td>
        {{ msg.subject }}
      </td>
      <td class="message-preview" title="{{ msg.message }}">
        {{ msg.message }}
      </td>
      <td>
        {{ msg.timestamp[:19].replace('T', ' ') }}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<div class="alert alert-info">
  Aucun message pour le moment.
</div>
{% endif %}

<div class="mt-4">
  <a href="{{ url_for('admin.admin_dashboard') }}" class="btn btn-outline-primary me-2">
    ‚Üê Retour au dashboard
  </a>
  <a href="{{ url_for('admin.admin_logout') }}" class="btn btn-outline-danger">
    D√©connexion
  </a>
</div>

</body>
</html>
